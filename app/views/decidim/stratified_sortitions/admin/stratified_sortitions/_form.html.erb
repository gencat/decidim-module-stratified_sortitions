<div class="form__wrapper">
  <div class="card pt-4">
    <div class="card-section">
      <div class="row column">
        <h3><%= t("decidim.stratified_sortitions.admin.strata.title", default: "Strata") %></h3>
        <div class="mt-4">
          <button class="button button__sm button__secondary add-question">Add stratum<%#= t(".add_question") %></button>
        </div>
        <div class="questionnaire-questions-list flex flex-col py-6 gap-6 last:pb-0"></div>
          <%# @form.strata.each_with_index do |stratum, index| %>
            <%#= fields_for "stratified_sortition[strata][]", stratum do |stratum_form| %>
              <%#= render "stratum_fields",
                        form: stratum_form,
                        id: tabs_id_for_question(stratum),
                        editable: questionnaire.questions_editable?,
                        display_condition_template_selector: "#display-condition-template-#{index}",
                        answer_option_template_selector: "#answer-option-template-#{index}",
                        matrix_row_template_selector: "#matrix-row-template-#{index}" %>
            <%# end %>
          <%# end %>
        </div>
      </div>

      <div class="row column hashtags__container">
        <%= form.translated :text_field, :title, autofocus: true, class: "js-hashtags", hashtaggable: true, aria: { label: :title } %>
      </div>

      <div class="row column">
        <%= form.number_field :num_candidates %>
      </div>

      <div class="row column hashtags__container">
        <%= form.translated :editor, :description %>
      </div>

      <div class="row column hashtags__container">
        <%= form.translated :editor, :selection_criteria %>
      </div>

      <div class="row column hashtags__container">
        <%= form.translated :editor, :selected_profiles_description %>
      </div>

      <div class="offer-tasks row column">
        <button class="button button__sm button__secondary add-stratum" type="button"><%= "add-stratum" %></button>

        <script type="text/template" class="decidim-template">
          <%= fields_for "stratified_sortition[stratum][#{blank_stratum.to_param}]", blank_stratum do |stratum_form| %>
            <%= render "stratum_fields", form: stratum_form, id: tabs_id_for_stratum(blank_stratum) %>
          <% end %>
        </script>

        <div class="offer-tasks-list">
          <% form.object.strata.each do |stratum| %>
            <%= fields_for "stratified_sortition[stratum][]", stratum do |stratum_form| %>
              <%= render "stratum_fields", form: stratum_form, id: tabs_id_for_stratum(stratum) %>
            <% end %>
          <% end %>
        </div>

      </div>
    </div>
  </div>
</div>

<%= append_javascript_pack_tag "decidim_stratified_sortitions_admin" %>
